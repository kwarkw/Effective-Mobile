# Задание 1 - Анализ требований (Функционал корзины)

Ниже перечислены логические противоречия/недочеты в фрагменте ТЗ и предложены исправления. В конце - список уточняющих вопросов.

## 1) Проблемы в исходном ТЗ

### 1.1. Противоречие: удаление товара
- П.2: "Для удаления товара из корзины используется отдельная кнопка."
- П.9: "Если пользователь уменьшает количество товара до 0, товар удаляется из корзины."
Проблема: неясно, какой способ удаления является основным/единственным. Это влияет на UI, логику API и аналитику действий пользователя.

### 1.2. Противоречие: фиксирование цены vs автоматическое обновление
- П.7: "Цена фиксируется на момент добавления в корзину и не меняется."
- П.13: "Если цена изменилась в каталоге, система должна автоматически обновить ее в корзине у всех пользователей."
Проблема: взаимоисключающие требования. Нельзя одновременно "не меняется" и "обновить у всех".

### 1.3. Неполнота: лимиты и правила их применения
- П.1: 1-10 единиц одного товара.
- П.3: максимум 5 различных товаров.
- П.4: суммарно максимум 20 штук.
- П.6: при превышении лимитов показывается сообщение "Лимит корзины превышен".
Проблема: не описано, что происходит с действием пользователя (запретить? откатить? частично применить?), какой лимит сработал, какой текст показывать, и применяются ли лимиты только при добавлении или также при изменении количества уже добавленного товара.

### 1.4. Нечеткость терминов и избыточность
- П.5: "Товары в корзине могут быть разные."
Проблема: требование не добавляет смысла и не определяет поведения. Возможно имелось в виду "разные SKU/варианты/магазины/поставщики", но это не сказано.

### 1.5. Неполнота по отображению стоимости
- П.8 перечисляет, что отображается (товары, количество, цена за единицу, общая стоимость позиции),
но не сказано:
- есть ли общая сумма корзины,
- как считается итог (скидки/промокоды/доставка/округления),
- что делать, если товар стал недоступен.

### 1.6. Неполнота требований к рекламе в корзине
- П.10: "В корзине может быть реклама других продуктов."
- П.11: "Реклама ... каждый будний день по утрам и вечерам."
Проблема: не определены "утро" и "вечер" (время), правила ротации, частота на пользователя, где именно на странице показывать, максимальное количество рекламных карточек, и как обрабатывать разные часовые пояса/локаль.

### 1.7. Пропуск нумерации
После пункта 11 в документе идет пункт 13.
Проблема: возможно отсутствует требование, которое меняет логику (например, про итоговую сумму, скидки и т.д.). Это риск неверной реализации.

---

## 2) Предложение исправлений (переписанный фрагмент ТЗ)

Ниже - согласованная версия требований, без противоречий.
Выбранный вариант:
- удаление выполняется через кнопку "Удалить", а количество не опускается ниже 1;
- цена в корзине отображается актуальная (из каталога) и может изменяться (это согласуется с требованием об автообновлении).

### 2.1. Количество и лимиты
1. В корзине хранится количество товара по SKU.
2. Для каждого SKU количество может быть от 1 до 10 включительно.
3. В корзине может быть не более 5 различных SKU одновременно.
4. Суммарное количество всех товаров в корзине (сумма количеств по всем SKU) не может превышать 20.
5. Пользователь может:
- добавить SKU в корзину,
- увеличить/уменьшить количество SKU в корзине,
- удалить SKU кнопкой "Удалить" (удаление = убрать позицию из корзины).
6. UI не позволяет установить количество ниже 1. Минимум 1. Для удаления используется кнопка "Удалить".

### 2.2. Обработка превышения лимитов
7. При попытке операции (добавление/изменение количества), которая приводит к нарушению любого лимита, операция НЕ применяется, а пользователю показывается сообщение:
- общий текст: "Лимит корзины превышен"
- дополнительно (в подстрочнике или в деталях ошибки) указывается причина:
  - "Максимум 10 единиц одного товара"
  - "Максимум 5 разных товаров"
  - "Максимум 20 товаров в корзине"
8. После сообщения корзина остается в предыдущем корректном состоянии.

### 2.3. Цена и стоимость
9. На странице корзины для каждой позиции отображается:
- название товара,
- количество,
- актуальная цена за единицу (из каталога),
- стоимость позиции = количество * цена за единицу.
10. Дополнительно отображается итоговая сумма корзины (сумма стоимостей позиций), если это предусмотрено дизайном.
11. Если цена товара изменилась в каталоге, при следующем открытии корзины и/или при пересчете корзины система показывает актуальную цену.
12. Если цена изменилась между открытиями корзины, пользователь видит актуальную цену, а также уведомление уровня "toast/баннер": "Цена некоторых товаров изменилась".

### 2.4. Реклама в корзине
13. На странице корзины может отображаться рекламный блок с рекомендованными товарами.
14. Показ рекламы ограничен 2 временными окнами в будний день (по локальному времени пользователя):
- утро: 08:00-12:00
- вечер: 17:00-21:00
15. В каждом окне пользователю показывается не более 1 рекламного блока (до 3 карточек товаров). Состав карточек фиксируется на время окна и может меняться в следующем окне.
16. На выходных рекламный блок в корзине не обязателен (по умолчанию не показывается).

---

## 3) Уточняющие вопросы заказчику / продукту

### 3.1. Про корзину и лимиты
1. Что такое "товар" в лимитах - продукт, SKU, вариант фасовки, товар у конкретного продавца?
2. Лимит "5 различных товаров" - это 5 SKU или 5 продуктовых карточек независимо от вариаций?
3. Лимит 20 штук - это единицы или "позиции"? Например, 1.5 кг весового товара как считается?
4. Лимиты применяются только при добавлении или также при изменении количества уже добавленного товара?
5. Что делать, если пользователь увеличил количество и уперся в лимит - откатить, поставить максимально допустимое, или показать ошибку и оставить старое значение?

### 3.2. Про удаление
6. Должно ли уменьшение количества до 0 удалять позицию (как в п.9) или удаление только через кнопку (как в п.2)?
7. Нужна ли подтверждающая модалка на удаление?

### 3.3. Про цену
8. Какое правило истинное: цена фиксируется на момент добавления или всегда актуальная?
9. Если цена меняется, нужно ли показывать уведомление пользователю? Какое и где?
10. Если товар стал недоступен/закончился - что делаем в корзине (удаляем автоматически, блокируем, предлагаем аналог)?

### 3.4. Про рекламу
11. Что считается "утром" и "вечером" (точные интервалы)?
12. Реклама должна быть одинаковой для всех или персонализированной?
13. Реклама обязана показываться всегда в окна (жесткое требование) или "может" (опционально)?
14. Где она расположена: сверху списка, внутри списка, внизу?
15. Есть ли ограничения по количеству показов на пользователя в день, и нужна ли аналитика кликов/показов?

